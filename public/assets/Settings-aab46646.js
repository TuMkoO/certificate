import{d as N,u as B,m as M,f as E,p as y,q as te,o as i,c as r,a as e,F,s as Q,i as L,x as J,l as I,v as H,j as a,n as S,k as A,t as x,y as se,z as G,g as z,A as w,h as j,w as Y,T as ae,B as le,_ as oe,C as ie}from"./index-39cd67e8.js";import{u as R,a as W,c as q}from"./index.esm-6a268568.js";import{_ as ne}from"./AppModal.vue_vue_type_script_setup_true_lang-8c976f45.js";const re={class:"sub-item"},de=e("div",{class:"certificate-form-field-title mt-4 mb-2"},[e("span",null,"Подгруппы:")],-1),ce={class:"mb-3"},ue=["value"],me=["id","value"],pe={key:0,class:"mb-3"},he={key:0,disabled:""},ve={key:1,disabled:""},be={key:2,disabled:""},ge=["value"],_e={class:"input-group mt-3"},fe={key:1,class:"form-text text-danger"},ye=N({__name:"SettingsCertificateFieldsSubItem",props:{storeLink:{},storeName:{},itemsList:{}},setup(V){const s=V,n=B(),d=M([]),c=M(""),u=M([]),v=M([]),{handleSubmit:h,resetForm:b}=R(),{value:p,errorMessage:g,handleBlur:f,handleChange:m}=W("newSubItem",q().trim().required("Введите подгруппу"));E(()=>{u.value=[],y(()=>n.getters["certItem/certAccessItems"]).value.forEach(t=>{u.value.push(t)})}),te(c,o=>{d.value=[],v.value=u.value.filter(t=>t.owner==o)});const $=h(async o=>{if(c.value){const t=s.storeLink;await n.dispatch("certItem/createSub",{values:o,link:t,certAccessId:c.value}),await n.dispatch("certItem/load",t);const l=y(()=>n.getters[`certItem/${s.storeName}`]);v.value=l.value.filter(_=>_.owner==c.value),u.value=l.value,b()}else n.dispatch("setMessage",{value:"Не выбрано значение основной группы",type:"warning"})}),k=async o=>{if(o.length){const t=s.storeLink;await o.forEach(_=>{n.dispatch("certItem/remove",{id:_,link:t})}),await n.dispatch("certItem/load",t);const l=y(()=>n.getters[`certItem/${s.storeName}`]);v.value=l.value.filter(_=>_.owner==c.value),u.value=l.value,d.value=[]}else n.dispatch("setMessage",{value:"Не выбрано значение для удаления",type:"warning"})};return(o,t)=>(i(),r("div",re,[de,e("div",ce,[e("div",null,[(i(!0),r(F,null,Q(o.itemsList,l=>(i(),r("label",{class:"d-block",key:l.id,value:l._id},[L(e("input",{type:"radio",id:"one"+l.id,value:l._id,"onUpdate:modelValue":t[0]||(t[0]=_=>c.value=_)},null,8,me),[[se,c.value]]),G(" "+x(l.value),1)],8,ue))),128))])]),o.itemsList?(i(),r("div",pe,[L(e("select",{class:"form-select",size:"4",multiple:"","aria-label":"multiple select example","onUpdate:modelValue":t[1]||(t[1]=l=>d.value=l)},[c.value?v.value.length==0?(i(),r("option",ve," Значений нет, добавьте новое ")):(i(),r("option",be,"Выберите значение")):(i(),r("option",he," Выберите значение основной группы ")),(i(!0),r(F,null,Q(v.value,l=>(i(),r("option",{key:l.id,value:l._id},x(l.value),9,ge))),128))],512),[[J,d.value]]),e("button",{class:"btn btn-sm btn-outline-danger mt-2",type:"button",onClick:t[2]||(t[2]=l=>k(d.value))}," Удалить ")])):I("",!0),e("div",_e,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(g)}]),placeholder:"Добавить подгруппу","aria-label":"Добавить подгруппу","aria-describedby":"button-addon3","onUpdate:modelValue":t[3]||(t[3]=l=>A(p)?p.value=l:null),onBlur:t[4]||(t[4]=(...l)=>a(f)&&a(f)(...l)),onChange:t[5]||(t[5]=(...l)=>a(m)&&a(m)(...l))},null,34),[[H,a(p)]]),e("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon3",onClick:t[6]||(t[6]=(...l)=>a($)&&a($)(...l))}," Добавить подгруппу ")]),a(g)?(i(),r("div",fe,x(a(g)),1)):I("",!0)]))}}),ke={class:"accordion-item"},we=["id"],xe=["data-bs-target","aria-expanded","aria-controls"],Ie=["id","aria-labelledby"],$e={class:"accordion-body"},Le={key:0,class:"mb-3"},Te={key:0,disabled:""},Me={key:1,disabled:""},Se=["value"],Ce={class:"input-group"},He=["placeholder","aria-label"],Ve={key:1,class:"form-text text-danger"},T=N({__name:"SettingsCertificateFieldsItem",props:{storeLink:{},placeholder:{},errorText:{},storeName:{},headingId:{},collapseId:{},opened:{type:Boolean},withItems:{type:Boolean},itemsList:{}},setup(V){const s=V,n=B(),d=M([]),c=M([]),u=y(()=>n.getters[`certItem/${s.storeName}`]),v=y(()=>n.getters["certItem/certAccessItems"]),{handleSubmit:h,resetForm:b}=R(),{value:p,errorMessage:g,handleBlur:f,handleChange:m}=W("newItem",q().trim().required(s.errorText));E(()=>{d.value=s.itemsList});const $=h(async o=>{const t=s.storeLink;await n.dispatch("certItem/create",{values:o,link:t}),await n.dispatch("certItem/load",t),d.value=u.value,b()}),k=async o=>{if(o.length){const t=s.storeLink;await o.forEach(l=>{if(n.dispatch("certItem/remove",{id:l,link:t}),v.value.length){const _=v.value.filter(C=>C.owner==l);if(_.length){const C="certificate-access-item";_.forEach(Z=>{n.dispatch("certItem/remove",{id:Z._id,link:C})})}}}),await n.dispatch("certItem/load",t),d.value=u.value,c.value=[]}else n.dispatch("setMessage",{value:"Не выбрано значение для удаления",type:"warning"})};return(o,t)=>(i(),r("div",ke,[e("h2",{class:"accordion-header",id:o.headingId},[e("button",{class:S(["accordion-button",{collapsed:!o.opened}]),type:"button","data-bs-toggle":"collapse","data-bs-target":"#"+o.collapseId,"aria-expanded":o.opened,"aria-controls":o.collapseId},x(o.placeholder),11,xe)],8,we),e("div",{id:o.collapseId,class:S(["accordion-collapse","collapse",{show:o.opened}]),"aria-labelledby":o.headingId,"data-bs-parent":"#accordionCertificateSettings"},[e("div",$e,[d.value?(i(),r("div",Le,[L(e("select",{class:"form-select",size:"4",multiple:"","aria-label":"multiple select example","onUpdate:modelValue":t[0]||(t[0]=l=>c.value=l)},[d.value.length===0?(i(),r("option",Te," Значений нет, добавьте новое ")):(i(),r("option",Me,"Выберите значение")),(i(!0),r(F,null,Q(d.value,l=>(i(),r("option",{key:l.id,value:l._id},x(l.value),9,Se))),128))],512),[[J,c.value]]),e("button",{class:"btn btn-sm btn-outline-danger mt-2",type:"button",onClick:t[1]||(t[1]=l=>k(c.value))}," Удалить ")])):I("",!0),e("div",Ce,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(g)}]),placeholder:o.placeholder,"aria-label":o.placeholder,"aria-describedby":"button-addon2","onUpdate:modelValue":t[2]||(t[2]=l=>A(p)?p.value=l:null),onBlur:t[3]||(t[3]=(...l)=>a(f)&&a(f)(...l)),onChange:t[4]||(t[4]=(...l)=>a(m)&&a(m)(...l))},null,42,He),[[H,a(p)]]),e("button",{class:"btn btn-outline-secondary",type:"button",id:"button-addon2",onClick:t[5]||(t[5]=(...l)=>a($)&&a($)(...l))}," Добавить ")]),a(g)?(i(),r("div",Ve,x(a(g)),1)):I("",!0),o.withItems?(i(),z(ye,{key:2,itemsList:d.value,storeLink:"certificate-access-item",storeName:"certAccessItems"},null,8,["itemsList"])):I("",!0)])],10,Ie)]))}}),Ae={class:"accordion",id:"accordionCertificateSettings"},We={class:"accordion-item"},qe=e("h2",{class:"accordion-header",id:"headingTextHead"},[e("button",{class:"accordion-button",type:"button","data-bs-toggle":"collapse","data-bs-target":"#collapseTextHead","aria-expanded":"true","aria-controls":"collapseTextHead"}," Текст в шапке Протокола ")],-1),Ne={id:"collapseTextHead",class:"accordion-collapse collapse show","aria-labelledby":"headingTextHead","data-bs-parent":"#accordionCertificateSettings"},Be={class:"accordion-body"},Ze={class:"form-floating"},Ee=e("label",{for:"textHead"},"Текст шапки",-1),Ue={key:0,class:"form-text text-danger"},ze=N({__name:"SettingsCertificateFields",setup(V){const s=B(),n=y(()=>s.getters["certItem/certTextHeads"]),d=y(()=>s.getters["certItem/certQualifyingRanks"]),c=y(()=>s.getters["certItem/certAttestationTypes"]),u=y(()=>s.getters["certItem/certWeldingMethods"]),v=y(()=>s.getters["certItem/certWeldedTypes"]),h=y(()=>s.getters["certItem/certWeldedSeams"]),b=y(()=>s.getters["certItem/certWeldedConnections"]),p=y(()=>s.getters["certItem/certWeldedPositions"]),g=y(()=>s.getters["certItem/certAxesPositions"]),f=y(()=>s.getters["certItem/certWeldedJoints"]),m=y(()=>s.getters["certItem/certBrands"]),$=y(()=>s.getters["certItem/certElectrodes"]),k=y(()=>s.getters["certItem/certComissions"]),o=y(()=>s.getters["certItem/certControls"]),t=y(()=>s.getters["certItem/certGrades"]),l=y(()=>s.getters["certItem/certAccesses"]),{handleSubmit:_}=R(),{value:C,errorMessage:Z}=W("textHead",q().trim().required("Введите текст шапки Протокола"));E(async()=>{C.value=n.value[0].value});const D=_(async O=>{const U="certificate-text-head",P=n.value[0]._id,ee={value:O.textHead};await s.dispatch("certItem/update",{newValues:ee,link:U,id:P})});return(O,U)=>(i(),r("div",Ae,[e("div",We,[qe,e("div",Ne,[e("div",Be,[e("div",Ze,[L(e("textarea",{placeholder:"Текст шапки",id:"textHead",style:{height:"150px"},class:S(["form-control",{"is-invalid":a(Z)}]),"onUpdate:modelValue":U[0]||(U[0]=P=>A(C)?C.value=P:null)},null,2),[[H,a(C)]]),Ee]),a(Z)?(i(),r("div",Ue,x(a(Z)),1)):I("",!0),e("button",{type:"button",class:"btn btn-outline-secondary mt-2",onClick:U[1]||(U[1]=(...P)=>a(D)&&a(D)(...P))}," Сохранить ")])])]),w(T,{itemsList:d.value,placeholder:"Квалификационный разряд",storeName:"certQualifyingRanks",storeLink:"certificate-qualifying-rank",errorText:"Введите квалификационный разряд",headingId:"headingQualifyingRanks",collapseId:"collapseQualifyingRanks"},null,8,["itemsList"]),w(T,{itemsList:c.value,placeholder:"Вид аттестации",storeName:"certAttestationTypes",storeLink:"certificate-attestation-type",errorText:"Введите вид аттестации",headingId:"headingAttestationType",collapseId:"collapseAttestationType"},null,8,["itemsList"]),w(T,{itemsList:m.value,placeholder:"Марка и группа",storeName:"certBrands",storeLink:"certificate-brand",errorText:"Введите марку и группу",headingId:"headingBrand",collapseId:"collapseBrand"},null,8,["itemsList"]),w(T,{itemsList:u.value,placeholder:"Способ сварки",storeName:"certWeldingMethods",storeLink:"certificate-welding-method",errorText:"Введите cпособ сварки",headingId:"headingWeldingMethod",collapseId:"collapseWeldingMethod"},null,8,["itemsList"]),w(T,{itemsList:v.value,placeholder:"Вид свариваемых деталей",storeName:"certWeldedTypes",storeLink:"certificate-welded-type",errorText:"Введите вид свариваемых деталей",headingId:"headingWeldedType",collapseId:"collapseWeldedType"},null,8,["itemsList"]),w(T,{itemsList:h.value,placeholder:"Тип сварного шва",storeName:"certWeldedSeams",storeLink:"certificate-welded-seam",errorText:"Введите тип сварного шва",headingId:"headingWeldedSeam",collapseId:"collapseWeldedSeam"},null,8,["itemsList"]),w(T,{itemsList:b.value,placeholder:"Тип и вид соединения",storeName:"certWeldedConnections",storeLink:"certificate-welded-connection",errorText:"Введите тип и вид соединения",headingId:"headingWeldedConnection",collapseId:"collapseWeldedConnection"},null,8,["itemsList"]),w(T,{itemsList:p.value,placeholder:"Положение при сварке",storeName:"certWeldedPositions",storeLink:"certificate-welded-position",errorText:"Введите положение при сварке",headingId:"headingWeldedPosition",collapseId:"collapseWeldedPosition"},null,8,["itemsList"]),w(T,{itemsList:g.value,placeholder:"Положение осей стержней",storeName:"certAxesPositions",storeLink:"certificate-axes-position",errorText:"Введите положение осей стержней",headingId:"headingAxesPosition",collapseId:"collapseAxesPosition"},null,8,["itemsList"]),w(T,{itemsList:f.value,placeholder:"Тип сварного соединения",storeName:"certWeldedJoints",storeLink:"certificate-welded-joint",errorText:"Введите тип сварного соединения",headingId:"headingWeldedJoint",collapseId:"collapseWeldedJoint"},null,8,["itemsList"]),w(T,{itemsList:$.value,placeholder:"Электрод или присадочная проволока",storeName:"certElectrodes",storeLink:"certificate-electrode",errorText:"Введите электрод или присадочную проволоку",headingId:"headingElectrode",collapseId:"collapseElectrode"},null,8,["itemsList"]),w(T,{itemsList:t.value,placeholder:"Оценка",storeName:"certGrades",storeLink:"certificate-grade",errorText:"Введите оценку",headingId:"headingGrade",collapseId:"collapseGrade"},null,8,["itemsList"]),w(T,{itemsList:o.value,placeholder:"Контроль качества образца",storeName:"certControls",storeLink:"certificate-control",errorText:"Введите вид контроля качества образца",headingId:"headingControl",collapseId:"collapseControl"},null,8,["itemsList"]),w(T,{itemsList:l.value,placeholder:"Группы технических устройств опасных производственных объектов",storeName:"certAccesses",storeLink:"certificate-access",errorText:"Введите группу технических устройств опасных производственных объектов",headingId:"headingAccess",collapseId:"collapseAccess",withItems:""},null,8,["itemsList"]),w(T,{itemsList:k.value,placeholder:"Аттестационная комиссия",storeName:"certComissions",storeLink:"certificate-comission",errorText:"Введите членов аттестационной комиссии",headingId:"headingComission",collapseId:"collapseComission"},null,8,["itemsList"])]))}}),Re={class:"mb-3"},Pe={class:"form-floating"},Fe=e("label",{for:"logo-text"},"Текст логотипа",-1),Qe={key:0,class:"form-text text-danger"},Ge={class:"mb-3"},Je={class:"form-floating"},je=e("label",{for:"logo-link"},"Ссылка в логотипе",-1),De={key:0,class:"form-text text-danger"},Oe={class:"mb-3"},Ke={class:"form-floating"},Xe=e("label",{for:"footer-text"},"Основной текст в футере",-1),Ye={key:0,class:"form-text text-danger"},et={class:"mb-3"},tt={class:"form-floating"},st=e("label",{for:"footer-text"},"Вторая строка текста в футере",-1),at={class:"mb-3"},lt={class:"form-floating"},ot=e("label",{for:"footer-text"},"Ссылка в футере",-1),it={class:"mb-3"},nt={class:"form-floating"},rt=e("label",{for:"footer-text"},"Заголовок ссылки в футере",-1),dt=e("button",{type:"submit",class:"btn btn-primary"},"Сохранить",-1),ct=N({__name:"SettingsSystem",props:{system:{}},setup(V){const s=V,n=B(),d=M(""),c=M(""),u=M(""),{handleSubmit:v}=R(),{value:h,errorMessage:b}=W("link",q().trim().required("Пожалуйста, введите ссылку для логотипа")),{value:p,errorMessage:g}=W("brand",q().trim().required("Пожалуйста, введите название Организации")),{value:f,errorMessage:m}=W("footerText1",q().trim().required("Пожалуйста, введите текст для футера"));E(()=>{p.value=s.system.brand,h.value=s.system.link,f.value=s.system.footer.mainText,s.system.footer.secondaryText?d.value=s.system.footer.secondaryText:d.value="",s.system.footer.link?c.value=s.system.footer.link:c.value="",s.system.footer.linkTitle?u.value=s.system.footer.linkTitle:u.value=""});const $=v(async()=>{const k=s.system._id,o={brand:p.value,link:h.value,footer:{mainText:f.value,secondaryText:d.value,link:c.value,linkTitle:u.value}};try{await n.dispatch("system/update",{values:o,id:k})}catch{}});return(k,o)=>(i(),r("form",{onSubmit:o[6]||(o[6]=j((...t)=>a($)&&a($)(...t),["prevent"]))},[e("div",Re,[e("div",Pe,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(g)}]),id:"logo-text",placeholder:"Текст логотипа","onUpdate:modelValue":o[0]||(o[0]=t=>A(p)?p.value=t:null)},null,2),[[H,a(p)]]),Fe]),a(g)?(i(),r("div",Qe,x(a(g)),1)):I("",!0)]),e("div",Ge,[e("div",Je,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(b)}]),id:"logo-link",placeholder:"Ссылка логотипа","onUpdate:modelValue":o[1]||(o[1]=t=>A(h)?h.value=t:null)},null,2),[[H,a(h)]]),je]),a(b)?(i(),r("div",De,x(a(b)),1)):I("",!0)]),e("div",Oe,[e("div",Ke,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(m)}]),id:"footer-text1",placeholder:"Основной текст в футере","onUpdate:modelValue":o[2]||(o[2]=t=>A(f)?f.value=t:null)},null,2),[[H,a(f)]]),Xe]),a(m)?(i(),r("div",Ye,x(a(m)),1)):I("",!0)]),e("div",et,[e("div",tt,[L(e("input",{type:"text",class:"form-control",id:"footer-text2",placeholder:"Вторая строка текста в футере","onUpdate:modelValue":o[3]||(o[3]=t=>d.value=t)},null,512),[[H,d.value]]),st])]),e("div",at,[e("div",lt,[L(e("input",{type:"text",class:"form-control",id:"footer-link",placeholder:"Ссылка в футере","onUpdate:modelValue":o[4]||(o[4]=t=>c.value=t)},null,512),[[H,c.value]]),ot])]),e("div",it,[e("div",nt,[L(e("input",{type:"text",class:"form-control",id:"footer-link-title",placeholder:"Заголовок ссылки в футере","onUpdate:modelValue":o[5]||(o[5]=t=>u.value=t)},null,512),[[H,u.value]]),rt])]),dt],32))}}),ut={class:"mb-3"},mt={class:"form-floating"},pt=e("label",{for:"qr-link"},"Базовая ссылка в QR коде",-1),ht={key:0,class:"form-text text-danger"},vt=e("button",{type:"submit",class:"btn btn-primary"},"Сохранить",-1),bt=N({__name:"SettingsQr",setup(V){const s=B(),n=M(null),{handleSubmit:d}=R(),{value:c,errorMessage:u}=W("link",q().trim().required("Пожалуйста, введите базовую ссылку для Qr кода"));E(()=>{const h=y(()=>s.getters["qr/qrs"]);c.value=h.value[0].link,n.value=h.value[0]._id});const v=d(async h=>{const b=n.value;try{await s.dispatch("qr/update",{values:h,id:b})}catch{}});return(h,b)=>(i(),r("form",{onSubmit:b[1]||(b[1]=j((...p)=>a(v)&&a(v)(...p),["prevent"]))},[e("div",ut,[e("div",mt,[L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(u)}]),id:"qr-link",placeholder:"Базовая ссылка в QR коде","onUpdate:modelValue":b[0]||(b[0]=p=>A(c)?c.value=p:null)},null,2),[[H,a(c)]]),pt]),a(u)?(i(),r("div",ht,x(a(u)),1)):I("",!0)]),vt],32))}}),gt={class:"mb-3"},_t=e("label",{for:"email",class:"form-label"},"Email",-1),ft={key:0,class:"form-text text-danger"},yt={class:"mb-3"},kt=e("label",{for:"fio",class:"form-label"},"ФИО",-1),wt={key:0,class:"form-text text-danger"},xt={key:0,class:"mb-3"},It=e("label",{for:"password",class:"form-label"},"Пароль",-1),$t={key:0,class:"form-text text-danger"},Lt={class:"mb-3"},Tt=e("label",{class:"form-label"},"Права пользователя",-1),Mt=e("option",{value:"user",selected:""},"Пользователь",-1),St=e("option",{value:"admin"},"Администратор",-1),Ct=[Mt,St],Ht={key:0,class:"form-text text-danger"},Vt={type:"submit",class:"btn btn-primary"},K=7,X=N({__name:"SettingsUsersForm",props:{buttonTitle:{},submitType:{},user:{}},emits:["success"],setup(V,{emit:s}){const n=V,d=B(),{handleSubmit:c,resetForm:u}=R();E(()=>{var t;m.value="user",n.user&&((t=n.user.roles)!=null&&t.length)&&(v.value=n.user.email,g.value=n.user.name,m.value=n.user.roles[0])});const{value:v,errorMessage:h}=W("email",q().trim().required("Пожалуйста, введите email").email("Необходимо ввести корректный email")),{value:b,errorMessage:p}=W("password",q().trim().required("Пожалуйста, введите пароль").min(K,`Пароль не может быть меньше ${K} символов`)),{value:g,errorMessage:f}=W("name",q().trim().required("Пожалуйста, введите имя").min(5,"Имя не может быть меньше 5 символов")),{value:m,errorMessage:$}=W("role",q().required("Пожалуйста, укажите права пользователя"));async function k({values:t,errors:l,results:_}){var C;n.submitType=="update"&&l.password&&t.email&&t.name&&t.role?(await d.dispatch("auth/updateById",{email:t.email,name:t.name,role:t.role,id:(C=n.user)==null?void 0:C.id}),s("success"),d.dispatch("setMessage",{value:"Данные пользователя успешно обновлены",type:"primary"})):d.dispatch("setMessage",{value:"Не все поля заполнены. Введите значения",type:"warning"})}const o=c(async t=>{try{n.submitType=="register"&&(await d.dispatch("auth/register",t),s("success"),u(),m.value="user")}catch{}},k);return(t,l)=>(i(),r("form",{onSubmit:l[4]||(l[4]=j((..._)=>a(o)&&a(o)(..._),["prevent"]))},[e("div",gt,[_t,L(e("input",{type:"email",class:S(["form-control",{"is-invalid":a(h)}]),id:"email","aria-describedby":"emailHelp",placeholder:"name@example.com","onUpdate:modelValue":l[0]||(l[0]=_=>A(v)?v.value=_:null)},null,2),[[H,a(v)]]),a(h)?(i(),r("div",ft,x(a(h)),1)):I("",!0)]),e("div",yt,[kt,L(e("input",{type:"text",class:S(["form-control",{"is-invalid":a(f)}]),id:"fio","aria-describedby":"emailHelp",placeholder:"ФИО","onUpdate:modelValue":l[1]||(l[1]=_=>A(g)?g.value=_:null)},null,2),[[H,a(g)]]),a(f)?(i(),r("div",wt,x(a(f)),1)):I("",!0)]),t.submitType=="register"?(i(),r("div",xt,[It,L(e("input",{type:"password",class:S(["form-control",{"is-invalid":a(p)}]),id:"password",placeholder:"Пароль","onUpdate:modelValue":l[2]||(l[2]=_=>A(b)?b.value=_:null)},null,2),[[H,a(b)]]),a(p)?(i(),r("div",$t,x(a(p)),1)):I("",!0)])):I("",!0),e("div",Lt,[Tt,L(e("select",{class:S(["form-select",{"is-invalid":a($)}]),"aria-label":"Roles","onUpdate:modelValue":l[3]||(l[3]=_=>A(m)?m.value=_:null)},Ct,2),[[J,a(m)]]),a($)?(i(),r("div",Ht,x(a($)),1)):I("",!0)]),e("button",Vt,x(t.buttonTitle),1)],32))}}),At={class:"auth-card card p-4"},Wt=e("ul",{class:"nav nav-tabs",id:"authTab",role:"tablist"},[e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link active",id:"register-tab","data-bs-toggle":"tab","data-bs-target":"#register",type:"button",role:"tab","aria-controls":"register","aria-selected":"false"}," Регистрация ")]),e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link",id:"users-tab","data-bs-toggle":"tab","data-bs-target":"#users",type:"button",role:"tab","aria-controls":"users","aria-selected":"false"}," Пользователи ")])],-1),qt={class:"tab-content",id:"authContent"},Nt={class:"tab-pane fade show active",id:"register",role:"tabpanel","aria-labelledby":"register-tab"},Bt={class:"mt-3"},Zt={class:"tab-pane fade",id:"users",role:"tabpanel","aria-labelledby":"users-tab"},Et={class:"mt-3"},Ut={class:"table-responsive"},zt={class:"table table-sm table-bordered"},Rt=e("thead",{class:"fs-7"},[e("tr",null,[e("th",{scope:"col",class:"text-center align-middle"},"Email"),e("th",{scope:"col",class:"text-center align-middle"},"ФИО"),e("th",{scope:"col",class:"text-center align-middle"},"Права"),e("th",{scope:"col",class:"text-center align-middle"}," Управление ")])],-1),Pt={class:"text-center align-middle"},Ft={class:"text-center"},Qt=["onClick"],Gt=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil-square",viewBox:"0 0 16 16"},[e("path",{d:"M15.502 1.94a.5.5 0 0 1 0 .706L14.459 3.69l-2-2L13.502.646a.5.5 0 0 1 .707 0l1.293 1.293zm-1.75 2.456-2-2L4.939 9.21a.5.5 0 0 0-.121.196l-.805 2.414a.25.25 0 0 0 .316.316l2.414-.805a.5.5 0 0 0 .196-.12l6.813-6.814z"}),e("path",{"fill-rule":"evenodd",d:"M1 13.5A1.5 1.5 0 0 0 2.5 15h11a1.5 1.5 0 0 0 1.5-1.5v-6a.5.5 0 0 0-1 0v6a.5.5 0 0 1-.5.5h-11a.5.5 0 0 1-.5-.5v-11a.5.5 0 0 1 .5-.5H9a.5.5 0 0 0 0-1H2.5A1.5 1.5 0 0 0 1 2.5v11z"})],-1),Jt=[Gt],jt=["onClick"],Dt=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-trash3",viewBox:"0 0 16 16"},[e("path",{d:"M6.5 1h3a.5.5 0 0 1 .5.5v1H6v-1a.5.5 0 0 1 .5-.5ZM11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3A1.5 1.5 0 0 0 5 1.5v1H2.506a.58.58 0 0 0-.01 0H1.5a.5.5 0 0 0 0 1h.538l.853 10.66A2 2 0 0 0 4.885 16h6.23a2 2 0 0 0 1.994-1.84l.853-10.66h.538a.5.5 0 0 0 0-1h-.995a.59.59 0 0 0-.01 0H11Zm1.958 1-.846 10.58a1 1 0 0 1-.997.92h-6.23a1 1 0 0 1-.997-.92L3.042 3.5h9.916Zm-7.487 1a.5.5 0 0 1 .528.47l.5 8.5a.5.5 0 0 1-.998.06L5 5.03a.5.5 0 0 1 .47-.53Zm5.058 0a.5.5 0 0 1 .47.53l-.5 8.5a.5.5 0 1 1-.998-.06l.5-8.5a.5.5 0 0 1 .528-.47ZM8 4.5a.5.5 0 0 1 .5.5v8.5a.5.5 0 0 1-1 0V5a.5.5 0 0 1 .5-.5Z"})],-1),Ot=[Dt],Kt={class:"modal-body"},Xt={key:0},Yt={key:0,class:"modal-footer"},es=N({__name:"SettingsUsers",setup(V){const s=B(),n=M(!1),d=M(""),c=M([]),u=M({});E(()=>{c.value=s.getters["auth/users"]});function v(g,f){n.value=!0,setTimeout(()=>{let m=document.getElementById("systemModal");m==null||m.classList.add("show")},0),u.value=g,f=="delete"&&(d.value="delete")}function h(){n.value=!1,d.value=""}async function b(){n.value=!1,await s.dispatch("auth/loadUsers"),c.value=s.getters["auth/users"]}async function p(g){await s.dispatch("auth/remove",g),await s.dispatch("auth/loadUsers"),c.value=s.getters["auth/users"],n.value=!1,d.value=""}return(g,f)=>(i(),r("div",At,[Wt,e("div",qt,[e("div",Nt,[e("div",Bt,[w(X,{buttonTitle:"Регистрация",submitType:"register",onSuccess:b})])]),e("div",Zt,[e("div",Et,[e("div",Ut,[e("table",zt,[Rt,e("tbody",null,[(i(!0),r(F,null,Q(c.value,(m,$)=>(i(),r("tr",{key:$},[e("td",null,x(m.email),1),e("td",null,x(m.name),1),e("td",Pt,[(i(!0),r(F,null,Q(m.roles,(k,o)=>(i(),r("span",{key:o,class:S(["badge","fw-normal",{"bg-danger":k=="admin"},{"bg-primary":k=="user"},{"bg-warning":k=="god"}])},x(k=="admin"?"Администратор":k=="user"?"Пользователь":k=="god"?"God":""),3))),128))]),e("td",Ft,[e("button",{type:"button",onClick:k=>v(m),title:"Изменить",class:"btn btn-outline-primary btn-sm"},Jt,8,Qt),e("button",{type:"button",onClick:k=>v(m,"delete"),class:"ms-2 btn btn-outline-danger btn-sm","data-bs-toggle":"tooltip","data-bs-placement":"top",title:"Удалить"},Ot,8,jt)])]))),128))])])])])])]),(i(),z(ae,{to:"body"},[n.value?(i(),z(ne,{key:0,title:"Изменить данные пользователя",onClose:h},{default:Y(()=>[e("div",Kt,[d.value=="delete"?(i(),r("p",Xt,[G(" Учетная запись пользователя "),e("b",null,x(u.value.name),1),G(" будет удалена. Вы подтверждаете удаление? ")])):(i(),z(X,{key:1,buttonTitle:"Сохранить",submitType:"update",user:u.value,onSuccess:b},null,8,["user"]))]),d.value=="delete"?(i(),r("div",Yt,[u.value.id?(i(),r("button",{key:0,type:"button",class:"btn btn-success",onClick:f[0]||(f[0]=m=>p(u.value.id))}," Удалить ")):I("",!0),e("button",{type:"button",class:"btn btn-danger",onClick:h}," Отмена ")])):I("",!0)]),_:1})):I("",!0)]))]))}}),ts={class:"container"},ss=e("div",{class:"py-4"},[e("h4",{class:"text-center mb-4"},"Настройки")],-1),as={key:1,class:"settings"},ls={class:"row"},os=e("ul",{class:"nav nav-tabs",id:"settingsTab",role:"tablist"},[e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link active",id:"settings-certificate-tab","data-bs-toggle":"tab","data-bs-target":"#settings-certificate",type:"button",role:"tab","aria-controls":"settings-certificate","aria-selected":"false"},[e("span",{class:"nav-link__text"},"Удостоверение"),e("span",{class:"nav-link__icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-file-earmark-text",viewBox:"0 0 16 16"},[e("path",{d:"M5.5 7a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1h-5zM5 9.5a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5zm0 2a.5.5 0 0 1 .5-.5h2a.5.5 0 0 1 0 1h-2a.5.5 0 0 1-.5-.5z"}),e("path",{d:"M9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V4.5L9.5 0zm0 1v2A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5z"})])])])]),e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link",id:"settings-system-tab","data-bs-toggle":"tab","data-bs-target":"#settings-system",type:"button",role:"tab","aria-controls":"settings-system","aria-selected":"true"},[e("span",{class:"nav-link__text"},"Системные"),e("span",{class:"nav-link__icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-gear",viewBox:"0 0 16 16"},[e("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"}),e("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"})])])])]),e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link",id:"settings-qr-tab","data-bs-toggle":"tab","data-bs-target":"#settings-qr",type:"button",role:"tab","aria-controls":"settings-qr","aria-selected":"true"},[e("span",{class:"nav-link__text"},"Qr код"),e("span",{class:"nav-link__icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-qr-code",viewBox:"0 0 16 16"},[e("path",{d:"M2 2h2v2H2V2Z"}),e("path",{d:"M6 0v6H0V0h6ZM5 1H1v4h4V1ZM4 12H2v2h2v-2Z"}),e("path",{d:"M6 10v6H0v-6h6Zm-5 1v4h4v-4H1Zm11-9h2v2h-2V2Z"}),e("path",{d:"M10 0v6h6V0h-6Zm5 1v4h-4V1h4ZM8 1V0h1v2H8v2H7V1h1Zm0 5V4h1v2H8ZM6 8V7h1V6h1v2h1V7h5v1h-4v1H7V8H6Zm0 0v1H2V8H1v1H0V7h3v1h3Zm10 1h-1V7h1v2Zm-1 0h-1v2h2v-1h-1V9Zm-4 0h2v1h-1v1h-1V9Zm2 3v-1h-1v1h-1v1H9v1h3v-2h1Zm0 0h3v1h-2v1h-1v-2Zm-4-1v1h1v-2H7v1h2Z"}),e("path",{d:"M7 12h1v3h4v1H7v-4Zm9 2v2h-3v-1h2v-1h1Z"})])])])]),e("li",{class:"nav-item",role:"presentation"},[e("button",{class:"nav-link",id:"settings-users-tab","data-bs-toggle":"tab","data-bs-target":"#settings-users",type:"button",role:"tab","aria-controls":"settings-users","aria-selected":"true"},[e("span",{class:"nav-link__text"},"Пользователи"),e("span",{class:"nav-link__icon"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor",class:"bi bi-people",viewBox:"0 0 16 16"},[e("path",{d:"M15 14s1 0 1-1-1-4-5-4-5 3-5 4 1 1 1 1h8zm-7.978-1A.261.261 0 0 1 7 12.996c.001-.264.167-1.03.76-1.72C8.312 10.629 9.282 10 11 10c1.717 0 2.687.63 3.24 1.276.593.69.758 1.457.76 1.72l-.008.002a.274.274 0 0 1-.014.002H7.022zM11 7a2 2 0 1 0 0-4 2 2 0 0 0 0 4zm3-2a3 3 0 1 1-6 0 3 3 0 0 1 6 0zM6.936 9.28a5.88 5.88 0 0 0-1.23-.247A7.35 7.35 0 0 0 5 9c-4 0-5 3-5 4 0 .667.333 1 1 1h4.216A2.238 2.238 0 0 1 5 13c0-1.01.377-2.042 1.09-2.904.243-.294.526-.569.846-.816zM4.92 10A5.493 5.493 0 0 0 4 13H1c0-.26.164-1.03.76-1.724.545-.636 1.492-1.256 3.16-1.275zM1.5 5.5a3 3 0 1 1 6 0 3 3 0 0 1-6 0zm3-2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"})])])])])],-1),is={class:"tab-content",id:"settingsContent"},ns={class:"tab-pane fade show active",id:"settings-certificate",role:"tabpanel","aria-labelledby":"settings-certificate-tab"},rs=e("h5",{class:"tab-pane-title my-4"},"Настройка выпадающих полей",-1),ds={class:"mt-3"},cs={class:"tab-pane fade",id:"settings-system",role:"tabpanel","aria-labelledby":"settings-system-tab"},us=e("h5",{class:"tab-pane-title my-4"},"Системные настройки",-1),ms={key:0,class:"mt-3"},ps={class:"tab-pane fade",id:"settings-qr",role:"tabpanel","aria-labelledby":"settings-qr-tab"},hs=e("h5",{class:"tab-pane-title my-4"},"Настройки QR кода",-1),vs={class:"mt-3"},bs={class:"tab-pane fade",id:"settings-users",role:"tabpanel","aria-labelledby":"settings-users-tab"},gs=e("h5",{class:"tab-pane-title my-4"},"Управление пользователями",-1),_s={class:"mt-3"},ws=N({__name:"Settings",setup(V){const s=B(),n=M(!1);le(async()=>{n.value=!0;const c="certificate-access",u="certificate-access-item",v="certificate-qualifying-rank",h="certificate-attestation-type",b="certificate-welding-method",p="certificate-welded-type",g="certificate-welded-seam",f="certificate-welded-connection",m="certificate-welded-position",$="certificate-axes-position",k="certificate-welded-joint",o="certificate-brand",t="certificate-electrode",l="certificate-comission",_="certificate-control",C="certificate-grade",Z="certificate-text-head";await s.dispatch("certItem/load",c),await s.dispatch("certItem/load",u),await s.dispatch("certItem/load",v),await s.dispatch("certItem/load",h),await s.dispatch("certItem/load",b),await s.dispatch("certItem/load",p),await s.dispatch("certItem/load",g),await s.dispatch("certItem/load",f),await s.dispatch("certItem/load",m),await s.dispatch("certItem/load",$),await s.dispatch("certItem/load",k),await s.dispatch("certItem/load",o),await s.dispatch("certItem/load",t),await s.dispatch("certItem/load",l),await s.dispatch("certItem/load",_),await s.dispatch("certItem/load",C),await s.dispatch("certItem/load",Z),await s.dispatch("qr/load"),await s.dispatch("auth/loadUsers"),n.value=!1});const d=y(()=>s.getters["system/systems"]);return(c,u)=>(i(),z(oe,{title:"Настройки"},{default:Y(()=>[e("div",ts,[ss,n.value?(i(),z(ie,{key:0})):(i(),r("div",as,[e("div",ls,[os,e("div",is,[e("div",ns,[rs,e("div",ds,[w(ze)])]),e("div",cs,[us,d.value?(i(),r("div",ms,[w(ct,{system:d.value},null,8,["system"])])):I("",!0)]),e("div",ps,[hs,e("div",vs,[w(bt)])]),e("div",bs,[gs,e("div",_s,[w(es)])])])])]))])]),_:1}))}});export{ws as default};
